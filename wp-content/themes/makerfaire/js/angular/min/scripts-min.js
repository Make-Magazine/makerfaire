function sortByKey(r,n){return r.sort(function(r,e){var a=r[n],t=e[n];return t>a?-1:a>t?1:0})}var ribbonApp=angular.module("ribbonApp",["ngRoute","angularUtils.directives.dirPagination"]);ribbonApp.directive("fallbackSrc",function(){var r={link:function n(r,e,a){e.bind("error",function(){angular.element(this).attr("src",a.fallbackSrc)})}};return r});var uniqueItems=function(r,n){for(var e=[],a=0;a<r.length;a++){var t=r[a][n];-1==e.indexOf(t)&&e.push(t)}return e};ribbonApp.filter("groupBy",function(){return function(r,n){return null!==r?uniqueItems(r,n):void 0}}),ribbonApp.controller("ribbonController",function(r,n){r.layout="grid",r.currentPage=1,r.pageSize=50,r.faires=[],r.blueList=[],r.redList=[],r.years=yearJson,r.loadData=function(e){var a={action:"getRibbonData",year:e};n.get("/wp-content/themes/makerfaire/partials/data/"+e+"ribbonData.json").success(function(n){r.ribbons=n,angular.forEach(n,function(n,e){angular.forEach(n.faireData,function(n,e){-1==r.faires.indexOf(n.faire)&&r.faires.push(n.faire)}),r.faires.sort(),n.blueCount>0&&r.blueList.push(n),n.redCount>0&&r.redList.push(n)}),r.blueList.sort(function(r,n){return parseFloat(n.blueCount)-parseFloat(r.blueCount)}),r.redList.sort(function(r,n){return parseFloat(n.redCount)-parseFloat(r.redCount)})}).error(function(r,n,e,a){alert("error")})},faireYear=r.years[0].name,r.loadData(faireYear),r.pageChangeHandler=function(r){console.log("meals page changed to "+r)}});