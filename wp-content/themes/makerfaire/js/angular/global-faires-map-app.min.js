!function(e){"use strict";e.module("faireMapsApp",["angularUtils.directives.dirPagination","ordinal"]),e.module("faireMapsApp").factory("FaireMapsSharedData",["$q",function(e){var t=e.defer();return{gmarkers1:[],infowindow:void 0,mapDone:function(){return t.promise},setMapDone:function(){t.notify(!0)}}}])}(window.angular),function(){"use strict";window.angular.module("faireMapsApp").factory("GMapsInitializer",["$window","$q",function(e,t){var a=t.defer();e.googleMapsInitialized=a.resolve;var i,r;return i="https://maps.googleapis.com/maps/api/js?key=AIzaSyDtWsCdftU2vI9bkZcwLxGQwlYmNRnT2VM&v=3.exp&callback=googleMapsInitialized",(r=document.createElement("script")).src=i,document.body.appendChild(r),a.promise}])}(),function(){"use strict";window.angular.module("faireMapsApp").controller("MapCtrl",["$http","$rootScope","$filter","FaireMapsSharedData",function(e,t,a,s){var o=this,l={filters:["Flagship","Featured","Mini"],search:"",pastEvents:!1};o.pastEvents=!1,t.$on("toggleMapFilter",function(e,t){var a=l.filters.indexOf(t.filter);t.state&&a<0?l.filters.push(t.filter):!t.state&&-1<a&&l.filters.splice(a,1),o.applyMapFilters()}),o.toggleBox=function(i){jQuery(".filters faires-map-filter").each(function(e,t){var a=jQuery(t).attr("filter"),e=l.filters.indexOf(a);a!==i?(jQuery(t).find("input").prop("checked",!1),-1<e&&l.filters.splice(e,1)):(jQuery(t).find("input").prop("checked",!0),e<0&&l.filters.push(a))}),o.applyMapFilters()},o.applyMapFilters=function(){s.infowindow.close(),o.pastPresent={past:0,present:0},l.search=o.filterText,l.pastEvents=o.pastEvents;var i=[],r=new Date;function n(e){if(!l.search)return 1;return function e(t,a){for(var i in t)if("object"==typeof t[i])e(t[i],a);else if("string"==typeof t[i]&&t[i].toLowerCase().match(a))return!0;return!1}(e,l.search.toLowerCase())}s.gmarkers1.map(function(e){var t,a=e.dataRowSrc;n(a)&&(t=a,-1<l.filters.indexOf(t.category))&&function(e){var t;if("[object Date]"!==Object.prototype.toString.call(e.event_end_dt)||isNaN(e.event_end_dt.getTime())){if("[object Date]"!==Object.prototype.toString.call(e.event_start_dt)||isNaN(e.event_start_dt.getTime()))return o.pastPresent.present++,1;t=e.event_start_dt}else t=e.event_end_dt;var a=new Date(t);a.setDate(a.getDate()+1),a.setHours(0,0,0,0);var i=a.getTime()<r.getTime();return i?o.pastPresent.past++:o.pastPresent.present++,l.pastEvents==i}(a)?(i.push(a),e.setVisible(!0)):(o.pastPresent.past++,e.setVisible(!1))}),o.faireMarkers=i},e.get("/query/?type=map").then(function(e){o.faireMarkers=e&&e.data&&e.data.Locations,s.mapDone().then(null,null,function(){o.applyMapFilters()})},function(){})}])}(),function(){"use strict";window.angular.module("faireMapsApp").component("fairesMapFilter",{template:'<div class="checkbox">        <label>          <input type="checkbox" class="checkbox-fa-icon" ng-model="$ctrl.defaultState" ng-click="$ctrl.toggleFilter()">          <i class="fa fa-circle-o"></i>          <i class="fa fa-circle"></i>          <ng-transclude></ng-transclude>        </label>      </div>',transclude:!0,bindings:{filter:"@",defaultState:"="},replace:!0,controller:["$rootScope",function(t){var a=this;t.$on("toggleMapSearch",function(){a.defaultState=!0}),a.toggleFilter=function(){var e={filter:a.filter,state:a.defaultState};t.$emit("toggleMapFilter",e)}}]})}(),function(){"use strict";window.angular.module("faireMapsApp").component("fairesGoogleMap",{bindings:{mapId:"@id",mapData:"="},controller:["$rootScope","GMapsInitializer","FaireMapsSharedData","$filter",function(e,t,o,a){var l,i=this;function r(e){var t=new google.maps.StyledMapType([{stylers:[{hue:"#FFFFFF"},{visibility:"simplified"},{gamma:2},{weight:.5}]},{elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"landscape",stylers:[{color:"#FFFFFF"}]},{featureType:"all",elementType:"geometry",stylers:[{color:"#FFFFFF"},{visibility:"on"}]},{featureType:"water",stylers:[{color:"#d0eafc"}]},{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"all",stylers:[{visibility:"off"}]}],{name:"Custom Style"}),a="custom_style";function s(){var e=this.getMap();o.infowindow.setContent('<div id="content"><h3 class="firstHeading">'+this.title+'</h3><div id="bodyContent"><p>'+(this.dataRowSrc.venue_address_city||"")+(this.dataRowSrc.venue_address_state&&", "+this.dataRowSrc.venue_address_state||"")+(this.dataRowSrc.venue_address_country&&", "+this.dataRowSrc.venue_address_country+" "||"")+(this.dataRowSrc.event_dt||"")+"</p><p>"+(this.dataRowSrc.faire_url&&'<a href="'+this.dataRowSrc.faire_url+'" target="_blank">'+this.dataRowSrc.faire_url+"</a>"||"")+"</p></div></div>"),o.infowindow.open(e,this)}(l=new google.maps.Map(document.getElementById(e),{center:{lat:23.9758543,lng:1.4487502},disableDefaultUI:!0,scrollwheel:!1,zoomControl:!0,minZoom:1,zoom:2})).mapTypes.set(a,t),l.setMapTypeId(a),o.infowindow=new google.maps.InfoWindow({content:void 0}),function(e){for(var t,a,i,r,n=0;n<e.length;n++){switch(t=e[n],i={path:google.maps.SymbolPath.CIRCLE,scale:5,fillOpacity:1,strokeOpacity:0},r=1,t.category){case"Flagship":i.fillColor="#D42410",i.scale=11,r=2;break;case"Featured":i.fillColor="#085a7e",i.scale=8;break;case"School":i.fillColor="#7ED321";break;default:i.fillColor="#67D0F7"}a=new google.maps.Marker({position:{lat:parseFloat(t.lat),lng:parseFloat(t.lng)},icon:i,map:l,animation:google.maps.Animation.DROP,title:t.name,description:t.description,category:t.category,zIndex:r,dataRowSrc:t}),google.maps.event.addListener(a,"mouseover",s),a.dataRowSrc.event_end_dt=new Date(a.dataRowSrc.event_end_dt),a.dataRowSrc.event_start_dt=new Date(a.dataRowSrc.event_start_dt),o.gmarkers1.push(a)}o.setMapDone()}(i.mapData)}t.then(function(){r(i.mapId)})}]})}();
//# sourceMappingURL=global-faires-map-app.min.js.map