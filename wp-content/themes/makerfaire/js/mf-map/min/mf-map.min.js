"use strict";function formatDate(e){var t=new Date(e),a=t.getDate(),r=t.getMonth(),o=t.getFullYear();return["January","February","March","April","May","June","July","August","September","October","November","December"][r]+", "+a+" "+o}jQuery(document).ready(function(){Vue.use(VueTables.ClientTable),Vue.use(VueTables.Event);new Vue({el:"#directory",data:{columns:["mmap_date","mmap_eventname","physLoc","mmap_country","mmap_city","mmap_state","mmap_start_dt","mmap_end_dt"],tableData:[],options:{headings:{mmap_date:"Date",mmap_eventname:"Name",physLoc:"Location",mmap_country:"Country"},templates:{physLoc:function(e,t,a){var r=t.mmap_city;return t.mmap_state&&(r+=", "+t.mmap_state),r},mmap_date:function(e,t,a){var r=formatDate(t.mmap_start_dt);return t.mmap_end_dt!=t.mmap_start_dt&&(r+=" - "+formatDate(t.mmap_end_dt)),r}},columnsDisplay:{mmap_country:"desktop"},columnsClasses:{mmap_eventname:"col-name",physLoc:"col-location",mmap_country:"col-country",mmap_date:"col-date",mmap_city:"col-hidden",mmap_state:"col-hidden",mmap_start_dt:"col-hidden",mmap_end_dt:"col-hidden"},pagination:{chunk:5}},filterVal:"",map:null,mapDefaultZoom:2,mapDefaultPos:{lat:29.1070772,lng:-24.2299966},markers:""},created:function(){var t=this;axios.get("/wp-json/makemap/v1/mapdata/242").then(function(e){t.$refs.loadingIndicator.classList.add("hidden"),t.tableData=e.data.Locations,t.$refs.directoryGrid.setOrder("mmap_eventname",!0),t.detectBrowser(),t.getLocation(),t.initMap()}).catch(function(e){console.log(e),t.$refs.loadingIndicator.classList.add("hidden"),t.$refs.errorIndicator.classList.remove("hidden")})},methods:{detectBrowser:function(){var e=navigator.userAgent,t=this.$refs.map;-1!=e.indexOf("iPhone")||-1!=e.indexOf("Android")?(t.style.width="100%",t.style.height="300px"):(t.style.width="100%",t.style.height="400px")},initMap:function(){this.$refs.mapTableWrapper.classList.remove("map-table-hidden");var e=new google.maps.StyledMapType([{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}],{name:"Styled Map"}),t=this.$refs.map,a={center:this.mapDefaultPos,zoom:this.mapDefaultZoom,mapTypeControlOptions:{mapTypeIds:["roadmap","satellite","hybrid","terrain","styled_map"]}};this.map=new google.maps.Map(t,a),this.map.mapTypes.set("styled_map",e),this.map.setMapTypeId("styled_map"),this.addMarkers()},getLocation:function(){var e=new google.maps.InfoWindow,a=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};a.map.setCenter(t),a.map.setZoom(8)},function(){a.handleLocationError(!0,e,a.map.getCenter())}):a.handleLocationError(!1,e,a.map.getCenter())},handleLocationError:function(e,t,a){console.error("User location check failed")},doFilter:function(e){this.$refs.directoryGrid.setFilter(this.filterVal),this.addMarkers()},filterOverride:function(e){e.preventDefault()},onRowClick:function(e){var t={lat:parseFloat(e.row.mmap_lat),lng:parseFloat(e.row.mmap_lng)};this.map.panTo(t),this.map.setZoom(16)},addMarkers:function(){this.markers=this.tableData.map(function(e,t){var a={lat:parseFloat(e.mmap_lat),lng:parseFloat(e.mmap_lng)},r=new google.maps.Marker({position:a,label:""});return r.addListener("click",function(){new google.maps.InfoWindow({content:'<div style=""><h4>'+e.mmap_eventname+'</h4><p><a href="'+e.mmap_url+'" target="_blank">'+e.mmap_url+"</a></p></div>"}).open(this.map,r)}),r});new MarkerClusterer(this.map,this.markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}}})});
//# sourceMappingURL=mf-map.min.js.map