"use strict";function formatDate(e){var t=new Date(e),a=t.getDate(),r=t.getMonth(),o=t.getFullYear();return["January","February","March","April","May","June","July","August","September","October","November","December"][r]+", "+a+" "+o}function beforeDate(e){return new Date<e}jQuery(document).ready(function(){Vue.use(VueTables.ClientTable),Vue.use(VueTables.Event);new Vue({el:"#directory",data:{columns:["faire_year","faire_name","venue_address_street","venue_address_country","venue_address_city","venue_address_state","event_start_dt","event_end_dt"],tableData:[],options:{headings:{faire_year:"Date",faire_name:"Name",venue_address_street:"Location",venue_address_country:"Country"},templates:{venue_address_street:function(e,t,a){var r=t.venue_address_city;return t.venue_address_state&&(r+=", "+t.venue_address_state),r},faire_year:function(e,t,a){var r=formatDate(t.event_start_dt);return t.event_end_dt!=t.event_start_dt&&"11/30/-0001 12:00:00 am"!=t.event_end_dt&&(r+=" - "+formatDate(t.event_end_dt)),r}},columnsDisplay:{venue_address_country:"desktop"},columnsClasses:{faire_name:"col-name",venue_address_street:"col-location",venue_address_country:"col-country",faire_year:"col-date",venue_address_city:"col-hidden",venue_address_state:"col-hidden",event_start_dt:"col-hidden",event_end_dt:"col-hidden"},pagination:{chunk:5}},filterVal:"",map:null,mapDefaultZoom:2,mapMinZoom:2,mapMaxZoom:20,mapDefaultPos:{lat:29.1070772,lng:-4.2299966},markers:""},created:function(){var t=this,a=new Date;axios.get("https://stage.makerfaire.com/query/?type=map").then(function(e){t.$refs.loadingIndicator.classList.add("hidden"),t.outputData=e.data.Locations,t.tableData=t.outputData.filter(function(e){var t=new Date(e.event_start_dt);if(a<t)return e}),t.$refs.directoryGrid.setOrder("faire_year","event_start_dt",!0),t.detectBrowser(),t.getLocation(),t.initMap()}).catch(function(e){console.log(e),t.$refs.loadingIndicator.classList.add("hidden"),t.$refs.errorIndicator.classList.remove("hidden")})},methods:{detectBrowser:function(){var e=navigator.userAgent,t=this.$refs.map;-1!=e.indexOf("iPhone")||-1!=e.indexOf("Android")?(t.style.width="100%",t.style.height="300px"):(t.style.width="100%",t.style.height="450px")},initMap:function(){this.$refs.mapTableWrapper.classList.remove("map-table-hidden");var e=new google.maps.StyledMapType([{elementType:"geometry",stylers:[{color:"#f5f5f5"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f5f5"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]}],{name:"Styled Map"}),t=this.$refs.map,a={center:this.mapDefaultPos,zoom:this.mapDefaultZoom,minZoom:this.mapMinZoom,maxZoom:this.mapMaxZoom,restriction:{latLngBounds:{north:85,south:-85,west:-180,east:180},strictBounds:!0},mapTypeControlOptions:{mapTypeIds:["roadmap","satellite","hybrid","terrain","styled_map"]}};this.map=new google.maps.Map(t,a),this.map.mapTypes.set("styled_map",e),this.map.setMapTypeId("styled_map"),this.addMarkers()},getLocation:function(){var e=new google.maps.InfoWindow,a=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};a.map.setCenter(t),a.map.setZoom(8)},function(){a.handleLocationError(!0,e,a.map.getCenter())}):a.handleLocationError(!1,e,a.map.getCenter())},handleLocationError:function(e,t,a){console.error("User location check failed")},doFilter:function(e){this.$refs.directoryGrid.setFilter(this.filterVal),this.addMarkers()},filterOverride:function(e){e.preventDefault()},onRowClick:function(e){var t={lat:parseFloat(e.row.lat),lng:parseFloat(e.row.lng)};this.map.panTo(t),this.map.setZoom(16)},addMarkers:function(){this.markers=this.tableData.map(function(e,t){new Date<new Date(e.event_start_dt)&&console.log("hallelujah");var a={lat:parseFloat(e.lat),lng:parseFloat(e.lng)},r=new google.maps.Marker({position:a,label:""});return r.addListener("click",function(){new google.maps.InfoWindow({content:'<div style=""><h4>'+e.faire_name+'</h4><p><a href="'+e.faire_url+'" target="_blank">'+e.faire_url+"</a></p></div>"}).open(this.map,r)}),r});new MarkerClusterer(this.map,this.markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}}})});
//# sourceMappingURL=mf-map.min.js.map