!function(x){window.gwCopyObj=function(t){var y=this;for(prop in t)t.hasOwnProperty(prop)&&(y[prop]=t[prop]);function m(t){return parseInt(t)!=t}function I(t){if(!(t instanceof Object))return t;var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(t[i]);return e}y.init=function(){var t=x("#gform_wrapper_{0}".format(y.formId));t.on("click.gpcopycat",'.gwcopy input[type="checkbox"]',function(){x(this).is(":checked")?y.copyValues(this):y.clearValues(this)}),t.on("change.gpcopycat",".gwcopy input:not(:checkbox), .gwcopy textarea, .gwcopy select",function(){y.copyValues(this)}),t.find(".gwcopy").find("input, textarea, select").each(function(){x(this).is(":checkbox, :radio")?x(this).is(":checked")&&y.copyValues(this,y.overwriteOnInit):y.copyValues(this,y.overwriteOnInit)}),gform.addAction("gform_list_post_item_delete",function(t){0<t.parents(".gwcopy").length&&(y.clearValues(t),y.copyValues(t))}),t.data("GPCopyCat",y)},y.copyValues=function(t,a,l){var e=gf_get_input_id_by_html_id(x(t).parents(".gwcopy").attr("id")),i=y.fields[e];a=void 0!==a?a:y.overwrite,l=void 0!==l?l:a;for(var r=0;r<i.length;r++){var c=i[r],n=c.source,u=c.target,o=y.getFieldGroup(c,"source"),d=y.getFieldGroup(c,"target"),f=y.isListField(o)&&y.isListField(d),g=y.getGroupValues(o,"source",{sort:!(f||!y.isListField(d))&&y.getGroupValues(d,"target",{isListToList:f,sourceInputId:u}),isListToList:f,sourceInputId:n,targetInputId:u});if(y.isListField(d)){var p=d.parents(".ginput_list").find(".gfield_list_group").length,s=y.isListField(o)?o.parents(".ginput_list").find(".gfield_list_group").length:o.length,h=Math.floor(s-p),v=y.getMaxRowCount(d);if(h<0&&1<p)d.each(function(){var t=I(g);-1===x.inArray(x(this).val(),t)&&1<x(this).parents(".gfield_list").find("tbody tr").length&&gformDeleteListItem(x(this),v)});else if(0<h)for(var _=0;_<h&&!(0<v&&v<p+_+1);_++)gformAddListItem(d[d.length-1],y.getMaxRowCount(d));d=y.getFieldGroup(c,"target")}d.each(function(t){var e=x(this),i=e.is(":checkbox, :radio"),r=f?y.getListInputIndex(e):t,n=i||g[r]||x.isArray(g)&&g.join(" "),o=!1,p=null;if(o=i?d.is(":checked"):e.val(),!a&&o)return!0;if(!n&&!l)return!0;if(y.isListField(d))p=m(u)?g[t]:g[r],p=gform.applyFilters("gppc_copied_value",p,e,c),p=gform.applyFilters("gpcc_copied_value",p,e,c),e.val(p);else if(i)-1!=x.inArray(e.val(),g)&&e.prop("checked",!0);else if(1<d.length)p=gform.applyFilters("gppc_copied_value",g[r],e,c),p=gform.applyFilters("gpcc_copied_value",p,e,c),e.val(p);else if(g=g.filter(function(t,e){return""!=t}),p=gform.applyFilters("gppc_copied_value",y.cleanValueByInputType(g.join(" "),e.attr("type")),e,c,g),p=gform.applyFilters("gpcc_copied_value",p,e,c,g),0<e.parents(".gfield_price").length&&e.is('select, input[type="radio"], input[type="checkbox"]')&&-1===p.indexOf("|"))e.val(e.find('option[value^="'+p+'|"]').attr("value"));else if(e.is("select")&&0===e.find('option[value="'+p+'"]').length&&(p=e.find("option:first").val()),e.val(p),window.tinyMCE){var s=tinyMCE.get(e.attr("id"));s&&s.setContent(p)}e.addClass("gpcc-populated-input").parents(".gfield").addClass("gpcc-populated")}),d.is(":checkbox, :radio")?(a||d.filter(":checked"),d.keypress()):d.change().trigger("chosen:updated"),d.trigger("copy.gpcopycat")}},y.clearValues=function(t){for(var e=x(t).parents(".gwcopy").attr("id").replace("field_"+y.formId+"_",""),i=y.fields[e],r=0;r<i.length;r++){var n=i[r],o=[],p=y.getFieldGroup(n,"target"),s=y.getFieldGroup(n,"source");if(y.isListField(p)&&y.isListField(s))return;if(parseInt(n.source)==e&&x(t).is(":checkbox"))return y.overwrite&&p.prop("checked",!1),void y.copyValues(t,!0,!0);if(s.each(function(t){o[t]=x(this).val()}),p.each(function(t){var e=x(this),i=e.val(),r=e.is(":checkbox, :radio");e.is(":checkbox")?e.prop("checked",-1!==x.inArray(i,o)):r?e.prop("checked",!1):i==o[t]&&e.val(""),e.removeClass("gpcc-populated-input").parents(".gfield").removeClass("gpcc-populated")}).change(),y.isListField(p)){var a=y.getMaxRowCount(p);p.parents(".ginput_list").find(".gfield_list_group:not(:first)").each(function(){0===x(this).find('.gfield_list_cell input[value!=""]').length&&gformDeleteListItem(x(this).find("input").eq(0),a)})}}},y.cleanValueByInputType=function(t,e){return"number"==e&&(t=gformToNumber(t)),t},y.getFieldGroup=function(t,e){var i=t[e],r=parseInt(i),n=t[e+"FormId"],o=x("#field_"+n+"_"+r),p=o.find('input[name^="input"]:not( :button ), select[name^="input"], textarea[name^="input"]'),s=y.isListField(p);if(s&&(p=p.filter('[name="input_{0}[]"]'.format(r))),m(i)&&!s){var a=i.split(".")[1],l=p.filter('[id^="input_'+n+"_"+r+"_"+a+'"], input[name="input_'+i+'"]');p=l.length<=0?p.filter("#input_"+n+"_"+i):l}else m(i)&&s&&(p=p.filter(function(){var t=y.getListInputIndex(x(this));return t==y.getListInputIndex(i,t)}));return"source"==e&&p.is("input:radio, input:checkbox")&&(p=p.filter(":checked")),gform.applyFilters("gpcc_field_group",p,t,e,o)},y.getGroupValues=function(t,e,i){void 0===i&&(i={}),i=function(t,e){for(key in e)e.hasOwnProperty(key)&&void 0===t[key]&&(t[key]=e[key]);return t}(i,{sort:!1,isListToList:!1,sourceInputId:!1,targetInputId:!1});var r=[];if(t.each(function(t){var e=t;i.isListToList&&!m(i.targetInputId)&&(e=y.getListInputIndex(x(this))),r[e]=x(this).val()}),!1!==i.sort){for(var n=i.sort.filter(function(t,e){return i.sort.indexOf(t)==e&&""!=t}),o=[],p=0;p<n.length;p++){var s=r.indexOf(n[p]);-1!==s&&(o.push(r[s]),r.splice(s,1))}r=o.concat(r)}return r},y.isListField=function(t){return 0<t.parents(".ginput_list").length},y.getListInputIndex=function(t,e,i){if(void 0===e?i=!1:"boolean"==typeof e?(i=e,e=!1):void 0===i&&(i=!1),"object"==typeof t)var r=t.attr("name").match(/(\d+)/)[0],n=t.parents(".gfield_list_group"),o=n.find('[name="input_{0}[]"]'.format(r)),p=t.parents(".gfield_list_container").find(".gfield_list_group"),s=o.index(t)+1,a=p.index(n)+1;else{var l=t.split("."),c=e?e.split("."):[1,1];s=l[1],a=l[2]?l[2]:c[1]}var u=s+"."+a;return i?{index:u,column:s,row:a}:u},y.getMaxRowCount=function(t){for(var e=t.parents("li.gfield").attr("class").split(" "),i=0;i<e.length;i++)if(-1!==e[i].indexOf("gp-field-maxrows"))return parseInt(e[i].split("-")[3]);return 0},y.init()}}(jQuery);
//# sourceMappingURL=gp-copy-cat.js.map