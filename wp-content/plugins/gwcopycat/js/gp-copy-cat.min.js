(w=>{window.gwCopyObj=function(e){var I=this;for(prop in e)e.hasOwnProperty(prop)&&(I[prop]=e[prop]);function F(e){return parseInt(e)!=e}I.init=function(){gform.addFilter("gpcc_copied_value",function(e,t,i){return(w("#input_"+I.formId+"_"+i.source).hasClass("ginput_total")||t.hasClass("ginput_quantity"))&&(t=(t=gf_get_field_number_format(i.source,I.formId))||gf_get_field_number_format(i.target,I.formId),i=gformGetDecimalSeparator(t),e=gformCleanNumber(e,"","",i)),e});var e=w("#gform_wrapper_"+I.formId),s=(e.off("change.gpcopycat"),e.on("change.gpcopycat",".gwcopy input, .gwcopy textarea, .gwcopy select",function(){w(this).closest(".gfield_choice_all_toggle").length||(!w(this).is(":checkbox")||w(this).is(":checked")?I.copyValues(this):I.clearValues(this))}),e.find(".gwcopy:not(.gfield--type-list)").find("input, textarea, select, button").each(function(){var r,e;(w(this).is(":checkbox, :radio")||w(this).parents(".gfield_chainedselect").length)&&!w(this).is(":checked")||I.copyValues(this,I.overwriteOnInit),w(this).is("button")&&w(this)[0].id.includes("_select_all")&&(r=w(this).attr("data-label-select"),e=w(this).attr("data-label-deselect"),w(this)[0].onclick=null,w(this).on("click",function(){var i=w(this).text();w(this).siblings().each(function(e,t){i==r?w(t).find("input").prop("checked")||w(t).find("input").click():w(t).find("input").prop("checked")&&w(t).find("input").click()}),i==r?w(this).text(e):w(this).text(r)}))}),e.find(".gfield--type-list.gwcopy").find("input").first().each(function(){I.copyValues(this,I.overwriteOnInit)}),gform.addAction("gform_list_post_item_delete",function(e){0<e.parents(".gwcopy").length&&(I.clearValues(e),I.copyValues(e))}),[]);w(document).on("gform_post_conditional_logic",function(e,a,t,o){Array.isArray(t)&&(t.forEach(function(e){var t=I.getFieldSettings(e);if(t)for(var i,r,n=0;n<t.length;n++)-1===w.inArray(t[n].trigger,s)&&(s.push(t[n].trigger),"hidden"!=(i=w("#field_"+a+"_"+t[n].trigger).find("input, textarea, select")).parents(".gfield").attr("data-conditional-logic"))&&(r=!o,i.is(":checkbox")&&!i.filter(":checked").length||I.copyValues(i[0],r,!1))}),s=[])}),e.data("GPCopyCat",I)},I.getFieldSettings=function(e){return void 0!==I.fields[e]?I.fields[e]:!1!==I.getSourceFieldIdByTarget(e,!0)?I.getSourceFieldIdByTarget(e,!0):!1!==I.getSourceField(e,!0)?I.getSourceField(e,!0):[]},I.copyValues=function(s,l,c){var e=gf_get_input_id_by_html_id(w(s).parents(".gfield").attr("id")),t=I.getFieldSettings(e);isOverwriteOrig=void 0!==l?l:I.overwrite;for(var i=0,r=t.length;i<r;i++){var p=t[i],d=p.source,u=p.target,n=p.condition,a=p.conditionFormId,o=I.getFieldGroup(p,"source"),g=I.getFieldGroup(p,"target"),f=I.isListField(o)&&I.isListField(g),h=I.getGroupValues(o,"source",{sort:!(f||!I.isListField(g))&&I.getGroupValues(g,"target",{isListToList:f,sourceInputId:u}),isListToList:f,sourceInputId:d,targetInputId:u});if(l=gform.applyFilters("gpcc_is_overwrite",isOverwriteOrig,s,p,g,o,h),c=void 0!==c?c:l,n){n=n.split(".");if(!((e,t,i)=>{var r=w("#gform_"+e),n=w.makeArray(r.prop("elements")),r="^[a-z]*_"+e+"_"+t;i&&(r+="_"+i),r+="$";for(var a=new RegExp(r,"gi"),o=null,s=0;s<n.length;s++){var l=n[s].id;if(l)if(a.test(l)){o=n[s];break}}return o&&(/^(?:checkbox|radio)$/i.test(o.type)?o.checked:o.value)})(a,n[0],n[1]))continue}a=window.gform.applyFilters("gpcc_custom_copy",!1,s.id,o,g,p.source);if(!a)if(o.parents(".gfield_chainedselect").length)o.each(function(e,t){t.name.split("_").pop()===p.source&&((e=g.get(e)).value=t.value,w(e).trigger("change"))});else{if(I.isListField(g)){n=0<g.filter(function(){return""!==this.value}).length;if(!l&&n)return;var _=g.parents(".ginput_list").find(".gfield_list_group").length,a=(I.isListField(o)?o.parents(".ginput_list").find(".gfield_list_group"):o).length,v=Math.floor(a-_),m=I.getMaxRowCount(g);if(v<0&&1<_)g.each(function(){var e=(e=>{if(!(e instanceof Object))return e;var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(e[t]);return i})(h);-1===w.inArray(w(this).val(),e)&&1<w(this).parents(".gfield_list").find(".gfield_list_group").length&&gformDeleteListItem(w(this),m)});else if(0<v)for(var y=0;y<v&&!(0<m&&m<_+y+1);y++)gformAddListItem(g[g.length-1],I.getMaxRowCount(g));g=I.getFieldGroup(p,"target")}targetValues=[],!F(u)&&g.is(":checkbox")&&l&&g.prop("checked",!1),g.each(function(e){var t=w(this),i=t.is(":checkbox, :radio"),r=f?I.getListInputIndex(t):e,n=i||h[r]||w.isArray(h)&&h.join(" "),a=!1,o=null;return targetValues[e]=t.val(),t.is(":radio")&&t.parent().hasClass("image-choices-choice")&&t.parent().removeClass("image-choices-choice-selected"),a=i?g.is(":checked"):t.val(),!(l||!a||w(s).is("select")&&t.is("select"))||!n&&!c||(I.isListField(g)?(o=F(u)?h[e]:h[r],o=gform.applyFilters("gppc_copied_value",o,t,p,h),o=gform.applyFilters("gpcc_copied_value",o,t,p,h),t.val(o)):i?-1!=w.inArray(t.val(),gform.applyFilters("gpcc_copied_value",h,t,p,h))&&(t.prop("checked",!0),t.trigger("change"),t.parents(".gfield_price").length)&&gformCalculateTotalPrice(I.formId):1<g.length?(o=gform.applyFilters("gppc_copied_value",h[r],t,p,h),o=gform.applyFilters("gpcc_copied_value",o,t,p,h),t.val(o)):(h=h.filter(function(e,t){return""!=e}),o=gform.applyFilters("gppc_copied_value",I.cleanValueByInputType(h.join(" "),t.attr("type")),t,p,h),o=gform.applyFilters("gpcc_copied_value",o,t,p,h),0<t.parents(".gfield_price:not(.gfield_quantity)").length&&t.is('select, input[type="radio"], input[type="checkbox"]')&&-1===o.indexOf("|")?t.val(t.find('option[value^="'+o+'|"]').attr("value")):(t.is("select")&&0===t.find('option[value="'+o+'"]').length&&(o=t.find("option:first").val()),t.val(o),window.tinyMCE&&(a=tinyMCE.get(t.attr("id")))&&a.setContent(o))),(w(t.parent()[0]).hasClass("iti--separate-dial-code")||w(t.parent()[0]).hasClass("iti--inline-dropdown"))&&(n="gp_advanced_phone_field"+t[0].id.replace("input",""),i="#field"+(e="_"+I.formId+"_"+d),r="gp_advanced_phone_field"+e,a=void 0!==window[r]?window[r].getFormattedNumber():w(i).find(":input")[0].value,window[n].iti.setNumber(a)),w(t[0]).hasClass("has-inline-datepicker")&&(e=t[0].id.split("_").pop(),r=I.formId,w("#datepicker_"+r+"_"+e).datepicker("setDate",o)),void(o?t.addClass("gpcc-populated-input").parents(".gfield").addClass("gpcc-populated"):t.removeClass("gpcc-populated-input").parents(".gfield").removeClass("gpcc-populated")))}),g.is(":checkbox, :radio")?(l||g.filter(":checked"),g.keypress()):g.each(function(e){targetValues[e]!=w(this).val()&&(w(this).change().trigger("chosen:updated"),e=new Event("change",{bubbles:!0}),this.dispatchEvent(e))}),g.trigger("copy.gpcopycat")}}},I.clearValues=function(e){for(var t=w(e).parents(".gfield").attr("id").replace("field_"+I.formId+"_",""),i=I.getFieldSettings(t),r=0;r<i.length;r++){var n,a=i[r],o=[],s=I.getFieldGroup(a,"target"),l=I.getFieldGroup(a,"source"),c=I.isListField(s)&&I.isListField(l);window.gform.applyFilters("gpcc_custom_clear",!1,e.id,l,s,a.source)||c||(parseInt(a.source)==t&&w(e).is(":checkbox")?(I.overwrite&&s.prop("checked",!1),I.copyValues(e,!0,!0)):(l.each(function(e){o[e]=w(this).val()}),s.each(function(e){var t=w(this),i=t.val(),r=t.is(":checkbox, :radio"),n=t.is(":checkbox"),e=o[e];1==s.length&&(e=(o=o.filter(function(e,t){return""!=e})).join(" ")),e=I.cleanValueByInputType(e),e=gform.applyFilters("gppc_copied_value",e,t,a,o),e=gform.applyFilters("gpcc_copied_value",e,t,a,o),n&&t.is(":checked")?t.prop("checked",-1!==w.inArray(i,o)).change():r&&t.is(":checked")?t.prop("checked",!1).change():""!==i&&i==e&&t.val("").change(),w(t.parent()[0]).hasClass("iti--separate-dial-code")&&(n=t[0].id.replace("input",""),window["gp_advanced_phone_field"+n].iti.setNumber("")),t.removeClass("gpcc-populated-input").parents(".gfield").removeClass("gpcc-populated")}),I.isListField(s)&&(n=I.getMaxRowCount(s),s.parents(".ginput_list").find(".gfield_list_group:not(:first)").each(function(){0===w(this).find('.gfield_list_cell input[value!=""]').length&&gformDeleteListItem(w(this).find("input").eq(0),n)}))))}},I.cleanValueByInputType=function(e,t){return"number"==t&&(t=gf_global.gf_currency_config,e=gformCleanNumber(e,t.symbol_right,t.symbol_left,t.decimal_separator)),e},I.getFieldGroup=function(e,t){var i=e[t],r=parseInt(i),n=e[t+"FormId"],a=w("#field_"+n+"_"+r),o=a.find('input[name^="input"]:not( :button ), select[name^="input"], textarea[name^="input"]'),s=I.isListField(o);if("target"===t){var l=a.find(":input:first");if(gformIsHidden(l)&&"hidden"!==l.prop("type"))return w()}return s&&(o=o.filter('[name="input_'+r+'[]"]')),F(i)&&!s?(l=i.split(".")[1],o=(r=o.filter('[id^="input_'+n+"_"+r+"_"+l+'"], input[name="input_'+i+'"]')).length<=0?o.filter("#input_"+n+"_"+i):r):F(i)&&s&&(o=o.filter(function(){var e=I.getListInputIndex(w(this));return e==I.getListInputIndex(i,e)})),"source"==t&&1<o.length&&w(o[0]).closest(".ginput_container_password").length&&(o=o.filter("#input_"+n+"_"+i)),"source"==t&&o.is("input:radio, input:checkbox")&&(o=o.filter(":checked")),"source"==t&&o.is("select")&&o.attr("multiple")&&(o=o.find(":selected")),gform.applyFilters("gpcc_field_group",o,e,t,a)},I.getGroupValues=function(e,t,i){i=((e,t)=>{for(key in t)t.hasOwnProperty(key)&&void 0===e[key]&&(e[key]=t[key]);return e})(i=void 0===i?{}:i,{sort:!1,isListToList:!1,sourceInputId:!1,targetInputId:!1});var r=[];if(e.each(function(e){i.isListToList&&!F(i.targetInputId)&&(e=I.getListInputIndex(w(this))),r[e]=w(this).val()}),!1!==i.sort){for(var n=i.sort.filter(function(e,t){return i.sort.indexOf(e)==t&&""!=e}),a=[],o=0;o<n.length;o++){var s=r.indexOf(n[o]);-1!==s&&(a.push(r[s]),r.splice(s,1))}r=a.concat(r)}return r},I.isListField=function(e){var t;return void 0!==e.data("isListField")?e.data("isListField"):(t=0<e.parents(".ginput_list").length,e.data("isListField",t),t)},I.getSourceFieldIdByTarget=function(e,t){for(var i in I.fields)if(I.fields.hasOwnProperty(i))for(var r=I.fields[i],n=0;n<r.length;n++){var a=r[n];if(parseInt(a.target)===parseInt(e))return t?r:a.source}return!1},I.getSourceField=function(e,t){for(var i in I.fields)if(I.fields.hasOwnProperty(i))for(var r=I.fields[i],n=0;n<r.length;n++){var a=r[n];if(parseInt(a.source)===parseInt(e))return t?r:a.source}return!1},I.getListInputIndex=function(e,t,i){void 0===t?i=!1:"boolean"==typeof t?(i=t,t=!1):void 0===i&&(i=!1),t="object"==typeof e?(r=e.attr("name").match(/(\d+)/)[0],r=(n=e.parents(".gfield_list_group")).find('[name="input_'+r+'[]"]'),$groups=e.parents(".gfield_list_container").find(".gfield_list_group"),r=r.index(e)+1,$groups.index(n)+1):(n=e.split("."),e=t?t.split("."):[1,1],r=n[1],n[2]||e[1]);var r,n=r+"."+t;return i?{index:n,column:r,row:t}:n},I.getMaxRowCount=function(e){for(var t=e.parents(".gfield").attr("class").split(" "),i=0;i<t.length;i++)if(-1!==t[i].indexOf("gp-field-maxrows"))return parseInt(t[i].split("-")[3]);return 0},I.init()}})(jQuery);
//# sourceMappingURL=gp-copy-cat.js.map