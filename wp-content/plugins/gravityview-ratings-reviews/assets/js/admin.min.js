!function(o){"use strict";var n=o.extend({viewCommentSelector:"#preview-action .preview",editCommentTitleSelector:".wrap h2:first",listReviewsTitleSelector:".wrap h2:first",ratingsReviewsmetaboxSelector:"li#gravityview_ratings_reviews_entry"},GV_RATINGS_REVIEWS_ADMIN);n.init=function(){n._holder=".gv-star-rate-holder",n._star=".gv-star-rate",n._input=".gv-star-rate-field",n.isEditReviewScreen()&&(n.changeEditCommentTitle(),n.removeViewCommentButton(),n.bindRate()),n.isListReviewsScreen()&&n.changeListReviewsTitle(),n.isGravityViewScreen()&&(n.bindToHideViewConfig(),n.bindToShowViewConfig())},n.removeViewCommentButton=function(){o(n.viewCommentSelector).remove()},n.changeEditCommentTitle=function(){o(n.editCommentTitleSelector).text(n.edit_review_title)},n.bindRate=function(){n.starHolder=o(n._holder),n.star=n.starHolder.find(n._star),n.star.on("click touchend",n.starRateReview).on("mouseover",n.mouseOverStar).on("mouseout",n.mouseOutStar),n.initStarVal(),n.voteHolder=o(".gv-vote-rate-holder"),n.vote=o("a.gv-vote-up, a.gv-vote-down",n.voteHolder),n.vote.on("click touchend",n.voteRateReview),n.initVoteVal()},n.initStarVal=function(){n.starHolder.length&&n.setStars()},n.mouseOverStarHolder=function(e){o(".gv-star-rate").removeClass("gv-rate-mutated")},n.mouseOutStarHolder=function(e){n.setStars()},n.setStars=function(){var e=parseInt(o("#gv_review_rate").val(),10);1<=e&&e<=5&&o(".gv-star-rate:eq("+(e-1)+")").trigger("click")},n.mouseOverStar=function(e){var t=o(this),i=t.parents(n._holder).find(n._star),a=i.index(t);i.removeClass("gv-rate-mutated").each(function(e,t){t=o(t);a+1<=e||t.addClass("gv-rate-mutated")})},n.mouseOutStar=function(e){var t=o(this),i=t.parents(n._holder).find(n._star);i.index(t);i.not('[data-selected="1"]').removeClass("gv-rate-mutated")},n.starRateReview=function(e){var t=o(this),i=t.parents(n._holder),a=i.find(n._star),i=i.siblings(n._input),r=a.index(t);i.val(r+1),a.removeClass("gv-rate-mutated").attr("data-selected",0).each(function(e,t){t=o(t);r+1<=e||t.addClass("gv-rate-mutated").attr("data-selected",1)})},n.initVoteVal=function(){var e;n.voteHolder.length&&(-1===(e=parseInt(o("#gv_review_rate").val(),10))?o(".gv-vote-down").addClass("gv-rate-mutated").removeClass("on"):1===e&&o(".gv-vote-up").addClass("gv-rate-mutated").removeClass("on"))},n.voteRateReview=function(e){var e=o(e.target),t=0;return e.hasClass("gv-vote-up")?t=e.hasClass("gv-rate-mutated")?0:1:e.hasClass("gv-vote-down")&&(t=e.hasClass("gv-rate-mutated")?0:-1),o(".gv-rate-mutated",n.voteHolder).not(e).removeClass("gv-rate-mutated"),e.toggleClass("gv-rate-mutated"),o("#gv_review_rate").val(t),o(".gv-vote-rating-text",n.voteHolder).text(t),!1},n.changeListReviewsTitle=function(){o(n.listReviewsTitleSelector).html(n.list_reviews_title)},n.bindToHideViewConfig=function(){o(document).bind("gv_admin_views_hideViewConfig",n.hideMetabox)},n.bindToShowViewConfig=function(){o(document).bind("gv_admin_views_showViewConfig",n.showMetabox)},n.showMetabox=function(){o(n.ratingsReviewsmetaboxSelector).slideDown(150)},n.hideMetabox=function(){o(n.ratingsReviewsmetaboxSelector).slideUp(150)},n.isEditReviewScreen=function(){return"comment"===n.screen_id&&n.is_review},n.isListReviewsScreen=function(){return n.is_list_reviews},n.isGravityViewScreen=function(){return"gravityview"===n.screen_id},o(n.init)}(jQuery);