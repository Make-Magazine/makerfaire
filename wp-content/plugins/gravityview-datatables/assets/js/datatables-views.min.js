window.gvDTResponsive=window.gvDTResponsive||{},window.gvDTFixedHeaderColumns=window.gvDTFixedHeaderColumns||{},function($){$.fn.dataTable.ext.errMode="throw";var gvDataTables={tables:{},setUpFieldFilters:function(datatable,settings){var field_filters_location=datatable.init().field_filters;if(field_filters_location&&!$(datatable.columns().header()).find(".gv-dt-field-filter").length){const throttledSearch=$.fn.dataTable.util.throttle(function(table,val){(settings.oInit.serverSide?table.search(val):table).draw()},200);datatable.columns().every(function(index){var toDateInput,column=settings.aoColumns[index],that=this;if(column.searchable){if(input=$("<input/>").attr("type",column.atts.field_type).attr("placeholder",column.atts.placeholder).attr("min",column.atts.min||null).attr("max",column.atts.max||null).attr("step",column.atts.step||null),["select","chainedselect","checkbox","multiselect"].includes(column.atts.field_type)&&column.atts.options){var input=$("<select></select>").append($("<option>").val("").text(column.atts.placeholder||""));try{options=JSON.parse(column.atts.options)}catch(e){return void console.log(e)}$.each(options,function(d,j){input.append($("<option>").val($("<div />").html(j.value).text()).text($("<div />").html(j.text||j.label).text()))})}else"date_range"===column.atts.field_type?(input=$("<div/>").addClass("date-input-wrapper"),options=$("<input/>").attr("type","date").attr("title",column.atts.from_date_title).attr("min",column.atts.min||null).attr("max",column.atts.max||null).attr("step",column.atts.step||null),toDateInput=$("<input/>").attr("type","date").attr("title",column.atts.to_date_title).attr("min",column.atts.min||null).attr("max",column.atts.max||null).attr("step",column.atts.step||null),input.append(options).append(toDateInput)):"date"===column.atts.field_type&&input.removeAttr("placeholder").attr("title",column.atts.title);var options=settings.oSavedState?settings.oSavedState.columns[index].search.search:"";input.val(options),$(input).addClass(column.atts.class).attr("data-uid",column.atts.uid).on("click",function(e){e.stopPropagation()}).on("keydown",function(e){(e.metaKey||e.ctrlKey)&&(gvDataTables.cmdOrCtrlPressed="keydown")}).on("keyup",function(e){gvDataTables.cmdOrCtrlPressed=!1}).on("keydown keyup",function(e){return 13===(e.keyCode||e.which)?(e.preventDefault(),!1):("a"===e.key&&gvDataTables.cmdOrCtrlPressed&&$(this)[0].select(),!0)}).on("keyup.DT input.DT paste.DT cut.DT change.DT clear",function(e){var keyCode=e.keyCode||e.which,is_function_keys=keyCode<130&&112<keyCode;if(-1!==[13,16,17,18,33,34,35,36,37,38,39,40,91,93].indexOf(keyCode)||is_function_keys)return!0;$(this).hasClass("date-input-wrapper")?(keyCode=$(e.target).closest(".date-input-wrapper").find("input").index(e.target),$(this).parents("table.gv-datatables").find(".gv-dt-field-filter[data-uid="+$(this).data("uid")+"]").find("input:eq("+keyCode+")").val(e.target.value)):$(this).parents("table.gv-datatables").find(".gv-dt-field-filter[data-uid="+$(this).data("uid")+"]").val(this.value),settings.oInit.serverSide&&that.search()===this.value||throttledSearch(that,this.value)}),"both"===field_filters_location?$(input).appendTo($(that.footer()).empty()).clone(!0).appendTo($(that.header())):"header"===field_filters_location?$(input).appendTo($(that.header())):$(input).appendTo($(that.footer()).empty())}})}},init:function(){$(".gv-datatables").each(function(i,e){var options=window.gvDTglobals[i],viewId=$(this).attr("data-viewid");if(gvDataTables.tables[viewId]={emptyServerResponse:!1,data:options.ajax.data},options.buttons=gvDataTables.setButtons(options),options.drawCallback=function(data){window.gvEntryNotes&&window.gvEntryNotes.init(),data.json&&data.json.inlineEditTemplatesData&&$(window).trigger("gravityview-inline-edit/extend-template-data",data.json.inlineEditTemplatesData),$(window).trigger("gravityview-inline-edit/init")},options.initComplete=function(settings){gvDataTables.setUpFieldFilters(this.api(),settings)},options.ajax.data=function(e){return $.extend({},e,gvDataTables.tables[viewId].data)},i<gvDTFixedHeaderColumns.length&&gvDTFixedHeaderColumns.hasOwnProperty(i)&&("1"===gvDTFixedHeaderColumns[i].fixedheader.toString()&&(options.fixedHeader={headerOffset:$("#wpadminbar").outerHeight()}),"1"===gvDTFixedHeaderColumns[i].fixedcolumns.toString())&&(options.fixedColumns=!0),i<gvDTResponsive.length&&gvDTResponsive.hasOwnProperty(i)&&"1"===gvDTResponsive[i].responsive.toString()&&("1"===gvDTResponsive[i].hide_empty.toString()?options.responsive={details:{renderer:gvDataTables.customResponsiveRowRenderer}}:(options.responsive=!0,options.fixedColumns=!1)),options.rowGroupSettings&&options.rowGroupSettings.status&&1==+options.rowGroupSettings.status&&(!(options.fixedColumns=!(i={dataSrc:function(row){row=row[+options.rowGroupSettings.index];let $row_field;try{$row_field=$(row)}catch(e){$row_field={}}return $row_field.length&&void 0!==$row_field.attr("href")?$(row).text():row},startRender:null,endRender:null}))===options.rowGroupSettings.startRender&&(i.startRender=function(rows,group){return group}),!0===options.rowGroupSettings.endRender&&(i.endRender=function(rows,group){return group}),options.rowGroup=i),options.createdRow=function(row,dt,rowIndex){$(row).find("> td").each(function(columnIndex){$(this).attr("data-row-index",rowIndex),$(this).attr("data-column-index",columnIndex)})},options.columns.forEach(column=>{column.render=(data,type,row,settings)=>"sort"!==type?data:gvDataTables.tables?.[viewId]?.shadowData?.[settings.row]?.[settings.col]??data}),options.ajax&&(options.ajax=$.extend({},options.ajax,{dataFilter:function(data,type){return""!==data?data:(gvDataTables.tables[viewId].emptyServerResponse=!0,JSON.stringify({draw:options.ajax?.draw||0,recordsTotal:0,recordsFiltered:0,data:[]}))}})),!options.serverSide&&options.ajax&&(options._ajax=options.ajax,options.processing=!0,delete options.ajax),!options.serverSide&&options.footerCalculation){const existingCreatedRowFn=options.createdRow;options.createdRow=function(row,dt,rowIndex){"function"==typeof existingCreatedRowFn&&existingCreatedRowFn(row,dt,rowIndex),$(row).find("> td").each(function(columnIndex){$(this).attr("data-numeric-value",options.footerCalculation?.data?.[columnIndex]?.values[rowIndex])})},options.footerCallback=function(tfoot){const api=this.api(),footerCalculationRow=()=>$(tfoot).parent().find(".footer-calculation");if(0===footerCalculationRow().length){var columnCount=api.columns().nodes().length,cellContent="<td></td>".repeat(columnCount);let footerCalculationRowContent=$(`<tr class="footer-calculation" style="background-color: ${options.footerCalculation?.row_background_color||"white"};">${cellContent}</tr>`);window?.wp?.hooks&&(footerCalculationRowContent=window.wp.hooks.applyFilters("gk.datatables.footer-calculation.row-content",footerCalculationRowContent,{columnCount:columnCount,api:api})),$(tfoot).parent()["above"===options.footerCalculation?.row_position?"prepend":"append"](footerCalculationRowContent)}api.columns().every(function(columnIndex){const{scope,operation,label,decimals,field_type:fieldType,format_as_duration:formatAsDuration,format_as_currency:formatAsCurrency}=options.footerCalculation?.data?.[columnIndex]||{};var seconds,padding,pad,minutes,locale=(options.footerCalculation?.locale??"en-US").replace("_","-");let calculationResult,calculationResultFormatted;if("form"===scope)calculationResult=$(options.footerCalculation?.server_side_footer_markup).find("th").eq(columnIndex).data("numeric-value"),calculationResultFormatted=$(options.footerCalculation?.server_side_footer_markup).find("th").eq(columnIndex).html();else{let totalValues=0,minValue=1/0,maxValue=-1/0;calculationResult=api.cells(null,columnIndex,{page:"visible"===scope?"current":void 0}).nodes().toArray().reduce((accumulator,cell,index,array)=>{var value=$(cell).data("numeric-value");let numericValue;switch(operation){case"sum":case"avg":return numericValue=0,value&&(numericValue=parseFloat(value),isNaN(numericValue))&&(numericValue=0),"avg"===operation?(totalValues+=numericValue,index===array.length-1?totalValues/array.length:accumulator):accumulator+numericValue;case"min-fastest":case"min":return numericValue=parseFloat(value),isNaN(numericValue)||(minValue=Math.min(minValue,numericValue)),index===array.length-1?minValue:accumulator;case"max-slowest":case"max":return numericValue=parseFloat(value),isNaN(numericValue)||(maxValue=Math.max(maxValue,numericValue)),index===array.length-1?maxValue:accumulator;case"count":case"count-nonempty-consented":case"count-nonempty-checked":case"count-nonempty-selected":case"quiz-passed":case"quiz-passed-percent":return value?accumulator+1:accumulator;case"count-empty-unconsented":case"count-empty-unchecked":case"count-empty-unselected":case"quiz-failed":case"quiz-failed-percent":return value?accumulator:accumulator+1;default:return accumulator}},0),/quiz-.*-percent/.test(operation)&&(calculationResult=calculationResult/api.rows({page:"visible"===scope?"current":void 0}).count()*100),calculationResultFormatted=formatAsDuration?(calculationResultFormatted="human_readable"===formatAsDuration?function(seconds){var hours=Math.floor(seconds/3600),minutes=(seconds%=3600,Math.floor(seconds/60)),parts=(seconds%=60,[]);0<hours&&parts.push(hours+" "+(1===hours?"hour":"hours"));0<minutes&&parts.push(minutes+" "+(1===minutes?"minute":"minutes"));0<seconds&&parts.push(seconds+" "+(1===seconds?"second":"seconds"));return 0<parts.length?parts.join(", "):"0 seconds"}(calculationResult):(seconds=calculationResult,padding=2,pad=num=>num.toString().padStart(padding,"0"),hours=Math.floor(seconds/3600),minutes=Math.floor(seconds%3600/60),[hours,minutes,seconds%=60].map(pad).join(":"))).replace("hours",options.translations?.hours||"hours").replace("hour",options.translations?.hour||"hour").replace("minutes",options.translations?.minutes||"minutes").replace("minute",options.translations?.minute||"minute").replace("seconds",options.translations?.seconds||"seconds").replace("second",options.translations?.second||"second"):formatAsCurrency?function(amount,currency,locale="en-US",decimals=2){locale=new Intl.NumberFormat(locale,{style:"currency",currency:currency,minimumFractionDigits:decimals,maximumFractionDigits:decimals,currencyDisplay:"narrowSymbol"});return locale.format(amount)}(calculationResult,formatAsCurrency,locale,decimals):new Intl.NumberFormat(locale,{minimumFractionDigits:decimals,maximumFractionDigits:decimals}).format(calculationResult)}var hours=footerCalculationRow().find("td").eq(columnIndex);hours.attr("data-numeric-value",calculationResult),hours.attr("data-operation",operation),hours.attr("data-decimals",decimals),hours.attr("data-field-type",fieldType),hours.attr("data-format-as-duration",formatAsDuration),hours.attr("data-format-as-currency",formatAsCurrency),hours.attr("data-scope",scope);let footerCalculationRowCellContent=(label||"").replace("{result}",calculationResultFormatted||"");window?.wp?.hooks&&(calculationResultFormatted=window.wp.hooks.applyFilters("gk.datatables.footer-calculation.calculation-result",calculationResultFormatted,calculationResult,{scope:scope,operation:operation,decimals:decimals,fieldType:fieldType,columnIndex:columnIndex,api:api}),footerCalculationRowCellContent=window.wp.hooks.applyFilters("gk.datatables.footer-calculation.cell-content",footerCalculationRowCellContent,{calculationResultFormatted:calculationResultFormatted,calculationResult:calculationResult,fieldType:fieldType,scope:scope,operation:operation,decimals:decimals,label:label,columnIndex:columnIndex,api:api})),hours.html(footerCalculationRowCellContent)})}}(options=window?.wp?.hooks?wp.hooks.applyFilters("gk.datatables.options",options):options).serverSide||(gvDataTables.tables[viewId]={...gvDataTables.tables[viewId],allRecordsLoaded:!$(`form.gv-widget-search[data-viewid="${viewId}"]`).hasClass("gv-is-search"),shadowData:buildShadowDataObject({data:options.data,shadowData:options.shadowData,columns:options.columns})},$.fn.dataTable.ext.search.push(function(settings,searchData,dataIndex){var viewId=settings.oInit.viewid;const shadowData=gvDataTables.tables[viewId].shadowData;var form=$(`form[data-viewid="${viewId}"]`);const searchWidgetMode=$('input[type="hidden"][name="mode"]',form).val(),columns=settings.aoColumns;let searchWidgetValues=[];form.hasClass("gv-is-search")&&(supportedInputTypes=['input[type="search"]','input[type="text"]','input[type="password"]','input[type="file"]','input[type="radio"]:checked','input[type="checkbox"]:checked',"textarea","select"].join(","),searchWidgetValues=form.find(supportedInputTypes).map(function(){return{value:$(this).val().toLocaleLowerCase().trim(),filterName:$(this).attr("name")}}).get().filter(sv=>""!==sv.value));form=columns.map(column=>{var fieldFiltersColumn="footer"===settings.oInit.field_filters?$(column.nTf):$(column.nTh);let value="";var columnFilterValue=fieldFiltersColumn.find("input, select").val()??"";return["date","date_range"].includes(column.atts?.field_type)&&(fieldFiltersColumn=fieldFiltersColumn.find("input"),value=(fieldFiltersColumn.eq(0).val()+"--"+fieldFiltersColumn.eq(1).val()).replace(/--$/,"")),{value:(value||columnFilterValue).toString().toLocaleLowerCase().trim(),columnIndex:column.idx,column:column}}).filter(sv=>void 0!==sv.value&&""!==sv.value);if(0===searchWidgetValues.length&&0===form.length)return!0;if(searchWidgetValues.length&&gvDataTables.tables[viewId].allRecordsLoaded){var supportedInputTypes=({value:searchWidgetValue,filterName})=>{var column=columns.find(column=>filterName===column.name.replace("gv_","filter_").replace(".","_"));const exactMatch=searchWidgetValue.startsWith('"')&&searchWidgetValue.endsWith('"')||"select"===column?.atts?.field_type;if("gv_search"===filterName||"all"!==searchWidgetMode)return shadowData[dataIndex].some(cellValue=>(cellValue=(cellValue??"").toString().toLocaleLowerCase().trim(),exactMatch?cellValue===searchWidgetValue.replace(/"/g,""):cellValue.includes(searchWidgetValue)));if(!column)return!0;let cellValue=shadowData?.[dataIndex]?.[column.idx]??"";return cellValue=cellValue.toString().toLocaleLowerCase().trim(),exactMatch?cellValue===searchWidgetValue.replace(/"/g,""):cellValue.includes(searchWidgetValue)};if(!("all"===searchWidgetMode?searchWidgetValues.every(supportedInputTypes):searchWidgetValues.some(supportedInputTypes)))return!1}return form.every(({value:filterValue,columnIndex,column})=>{let cellValue=shadowData?.[dataIndex]?.[columnIndex]??searchData[column.idx]??"";cellValue=cellValue.toString().toLocaleLowerCase().trim();var toDate,columnIndex=(filterValue=filterValue??"").startsWith('"')&&filterValue.endsWith('"')||"select"===settings.oInit.aoColumns[columnIndex]?.atts?.field_type;return["date","date_range"].includes(column.atts.field_type)?([column,toDate]=filterValue.split("--"),column=new Date(column+"T00:00:00Z").getTime()||0,toDate=new Date(toDate+"T00:00:00Z").getTime()||0,cellValue=parseInt(cellValue,10),0===column&&0===toDate||0===column&&cellValue===toDate||0===toDate&&cellValue===column||cellValue>=column&&cellValue<=toDate):columnIndex?cellValue===filterValue.replace(/"/g,""):cellValue.includes(filterValue)})})),options.updateInterval&&0<options.updateInterval&&setInterval(function(){var table=gvDataTables.tables[viewId].table;options._ajax&&(table.settings()[0].ajax=options._ajax),table.ajax.reload(null,!1)},+options.updateInterval),options.searching||(options.searching=!0,options.hideSearchBar=!0),gvDataTables.tables[viewId].table=$(this).DataTable(options),options.hideSearchBar&&$(gvDataTables.tables[viewId].table.settings()[0].nTableWrapper).find(".dataTables_filter").remove(),gvDataTables.tables[viewId].table.on("draw.dt",function(e,settings){var api=new $.fn.dataTable.Api(settings),viewId=(api.column(0).data().length&&$(e.target).parents(".gv-container-no-results").removeClass("gv-container-no-results").siblings(".gv-widgets-no-results").removeClass("gv-widgets-no-results"),$(e.target).data("viewid")),tableData=gvDataTables.tables[viewId].data??null,getData=tableData&&tableData.hasOwnProperty("getData")?tableData.getData:null,$viewContainer=$(e.target).parents("div[id^=gv-view-]"),noEntriesOption=+tableData?.noEntriesOption,hideUntilSearched=+tableData?.hideUntilSearched;if(0!==api.data().length||0!==api.search().length||0!==api.columns().search().filter(function(string){return""!==string}).length||getData){!hideUntilSearched&&$(gvDataTables.tables[viewId].table.table().container()).is(":hidden")&&($viewContainer.find(".gv-widgets-header, .gv-widgets-footer, .gv-datatables-container").removeClass("gv-hidden"),$viewContainer.find("table.dataTable").css("width",""));api=$("<div/>").html(gvDataTables.tables[viewId].emptyServerResponse?options.language.emptyServerResponse:options.language.emptyTable).text();$(e.target).find(".dataTables_empty").text(api)}else{getData=$("<div/>").html(options.language.zeroRecords).text();switch($(e.target).find(".dataTables_empty").text(getData),noEntriesOption){case 1:$viewContainer.find("[id^=gv-datatables-],.gv-widgets-header,.gv-powered-by").hide().end().find(".gv-datatables-form-container").removeClass("gv-hidden");break;case 2:var redirectURL=tableData&&tableData.hasOwnProperty("redirectURL")?tableData.redirectURL:null;redirectURL.length&&(window.location=redirectURL);break;case 3:$(e.target).parents(".gv-datatables-container").hide()}}$(window).trigger("gravityview-datatables/event/draw",{e:e,settings:settings})}).on("preXhr.dt",function(e,settings,data){$(window).trigger("gravityview-datatables/event/preXhr",{e:e,settings:settings,data:data})}).on("processing.dt",function(e,settings,processing){processing&&gvDataTables.repositionLoader($(e.target))}).on("xhr.dt",function(e,settings,json,xhr){var shadowData;json?.shadowData&&(shadowData=buildShadowDataObject({data:json.data,shadowData:json.shadowData,columns:options.columns}),json.shadowData=shadowData,gvDataTables.tables[viewId].shadowData=shadowData),$(window).trigger("gravityview-datatables/event/xhr",{e:e,settings:settings,json:json,xhr:xhr})}).on("responsive-resize",function(e,datatable){gvDataTables.setUpFieldFilters(datatable,datatable.settings()[0])}).on("responsive-display",function(){var visible_divs,div_attr;$(window).trigger("gravityview-datatables/event/responsive"),0<(visible_divs=$(this).find("td:visible .gravityview-fancybox")).length&&visible_divs.each(function(i,e){(div_attr=$(this).attr("data-fancybox"))&&-1===div_attr.indexOf("mobile")&&(div_attr+="-mobile",$(this).attr("data-fancybox",div_attr))})}).on("column-visibility.dt",function(e,settings,columnIdx,state){state?$(".footer-calculation").find("td").eq(columnIdx).show():$(".footer-calculation").find("td").eq(columnIdx).hide()})})},repositionLoader:function($table){var topPosition,$container=$table.parents(".gv-datatables-container"),$thead=$table.find("thead"),$tbody=$table.find("tbody"),$tfoot=$table.find("tfoot"),$loader=$("div.dataTables_processing",$container),tbodyTop=($.fn.isInViewport=function(){var elementTop=$(this).offset().top,elementBottom=elementTop+$(this).outerHeight(),viewportTop=$(window).scrollTop(),viewportBottom=viewportTop+$(window).height();return viewportTop<=elementTop&&elementBottom<=viewportBottom},$tbody.position().top),theadHeight=$thead.outerHeight(),scrollTop=$(window).scrollTop(),containerTop=$container.offset().top,windowHeight=window.innerHeight||document.documentElement.clientHeight,loaderHeight=$loader.outerHeight(),adjustedViewportTop=scrollTop-containerTop+theadHeight,adjustedViewportBottom=scrollTop+windowHeight-containerTop-loaderHeight,viewportTop=Math.max(0,scrollTop-containerTop),$container=Math.min($container.outerHeight(),scrollTop+windowHeight-containerTop),scrollTop=Math.min($container-loaderHeight,Math.max(viewportTop,tbodyTop+theadHeight)),windowHeight=$table.isInViewport();windowHeight&&$tbody.height()>$loader.height()?topPosition="50%":windowHeight?topPosition=scrollTop:$tfoot.isInViewport()?topPosition=($tfoot.position().top-adjustedViewportTop)/2+adjustedViewportTop:$thead.isInViewport()&&(topPosition=(adjustedViewportBottom-scrollTop)/2+scrollTop),$loader.css({position:"absolute",top:topPosition})},setButtons:function(options){var buttons=[];return options&&options.buttons&&0<options.buttons.length&&options.buttons.forEach(function(button,i){"print"===button.extend?buttons[i]=$.extend(!0,{},gvDataTables.buttonCommon,gvDataTables.buttonCustomizePrint,button):buttons[i]=$.extend(!0,{},gvDataTables.buttonCommon,button)}),buttons},buttonCommon:{exportOptions:{columns:function(idx,data,node){var $wrapperEl=$(node).closest("div.dataTables_wrapper");return $wrapperEl.length&&($wrapperEl=$wrapperEl.find("table.gv-datatables"),$.fn.DataTable.isDataTable($wrapperEl))?$wrapperEl.dataTable().api().columns().visible()[idx]:$(node).is(":visible")},format:{header:function(data,columnIdx,row){return $(row).find(".gv-field-label").text()},body:function(data,column,row){return 0!==data.length&&(data=data.replace(/\n/g," "),data=$("<span>"+data+"</span>").find("li").after("; ").end().find("img").replaceWith(function(){return $(this).attr("alt")}).end().find(".dashicons.dashicons-yes").replaceWith(function(){return"&#10004;"}).end().find("br").replaceWith(" ").end().find(".map-it-link").remove().end().text()),data}}}},buttonCustomizePrint:{customize:function(win){$(win.document.body).find("table").addClass("compact").css("font-size","inherit").css("table-layout","auto")}},customResponsiveRowRenderer:function(api,rowIdx){var data=api.cells(rowIdx,":hidden").eq(0).map(function(cell){var idx,header=$(api.column(cell.column).header());return header.hasClass("control")||header.hasClass("never")||(idx=api.cell(cell).index(),0===api.cell(cell).data().length)?"":(cell=(cell=api.settings()[0]).oApi._fnGetCellData(cell,idx.row,idx.column,"display"),'<li data-dtr-index="'+idx.column+'"><span class="dtr-title">'+header.find(".gv-dt-field-filter").remove().end().text()+':</span> <span class="dtr-data">'+cell+"</span></li>")}).toArray().join("");return!!data&&$('<ul data-dtr-index="'+rowIdx+'"/>').append(data)}};function buildShadowDataObject({data,shadowData,columns}){return shadowData.map((row,rowIndex)=>row.map((cellValue,cellIndex)=>{return cellValue&&"email"===columns[cellIndex].atts?.field_type?cellValue.replace(/[a-zA-Z]/g,function(char){let charCode=char.charCodeAt(0);return 65<=charCode&&charCode<=90?charCode=(charCode-65+13)%26+65:97<=charCode&&charCode<=122&&(charCode=(charCode-97+13)%26+97),String.fromCharCode(charCode)}):""!==cellValue?cellValue:data[rowIndex]?$("<div>").html(data[rowIndex][cellIndex]).text():void 0}))}$(document).ready(function(){gvDataTables.init(),Object.keys(gvDataTables.tables).length&&Object.keys(gvDataTables.tables).forEach(function(viewId){const $searchWidgetForm=$(`form.gv-widget-search[data-viewid="${viewId}"]`);$(".gv-search-clear",$searchWidgetForm).off().on("click",function(e){var tableId=$("#gv-datatables-"+viewId).find(".dataTable").attr("id");if(tableId&&$.fn.DataTable.isDataTable("#"+tableId)&&gvDataTables.tables[viewId]){var tableData=gvDataTables.tables[viewId].data??null,isSearch=$searchWidgetForm.hasClass("gv-is-search"),e=(e.preventDefault(),e.stopImmediatePropagation(),$("#"+tableId));if(isSearch&&$searchWidgetForm.serialize()!==$searchWidgetForm.attr("data-state")){for(var formData={},serializedData=$searchWidgetForm.attr("data-state").split("&"),i=0;i<serializedData.length;i++){var item=serializedData[i].split("=");formData[decodeURIComponent(item[0])]=decodeURIComponent(item[1])}$.each(formData,function(name,value){$searchWidgetForm.find('[name="'+name+'"]').val(value)}),$(".gv-search-clear",$searchWidgetForm).text(gvGlobals.clear)}else{if($('input[type="search"], input:text, input:password, input:file, select, textarea',$searchWidgetForm).val(""),$("input:checkbox, input:radio",$searchWidgetForm).removeAttr("checked").removeAttr("selected"),$searchWidgetForm.serialize()!==$searchWidgetForm.attr("data-state")){tableData.getData=!1,gvDataTables.tables[viewId].data=tableData;const url=new URL(window.location.href);["gv_search","mode"].forEach(param=>url.searchParams.delete(param)),[...url.searchParams.keys()].forEach(key=>key.startsWith("filter_")&&url.searchParams.delete(key)),window.history.pushState(null,null,url.toString()),$searchWidgetForm.removeClass("gv-is-search"),$searchWidgetForm.attr("data-state",$searchWidgetForm.serialize());tableId=e.DataTable().init(),isSearch=(tableId._ajax&&(e.DataTable().settings()[0].ajax=tableId._ajax),tableId.serverSide||!tableId.serverSide&&!gvDataTables.tables[viewId].allRecordsLoaded);isSearch?(gvDataTables.tables[viewId].allRecordsLoaded=!0,e.DataTable().ajax.reload()):e.DataTable().draw()}$(this).hide(100)}}}),$searchWidgetForm.on("submit",function(e){if(e.preventDefault(),gvDataTables.tables[viewId]){var e=$("#gv-datatables-"+viewId),$table=0<e.find(".DTFC_ScrollWrapper").length?e.find(".dataTables_scrollBody .gv-datatables"):e.find(".gv-datatables"),tableData=gvDataTables.tables[viewId].data??null,inputs=$(this).serializeArray().filter(function(k){return""!==$.trim(k.value)});if($(this).serialize()!==$(this).attr("data-state"))if($(this).attr("data-state",$(this).serialize()),tableData){if(+tableData.hideUntilSearched&&delete tableData.hideUntilSearched,inputs=function(formValues){const result={};return formValues.forEach(item=>{var{name:item,value}=item;if(item.includes("[")){var keys=item.split(/\[|\]\[|\]/).filter(Boolean);let current=result;for(let i=0;i<keys.length;i++)i===keys.length-1?current[keys[i]]=value:(current[keys[i]]||(current[keys[i]]={}),current=current[keys[i]])}else result[item]=value}),result}(inputs),tableData.search={value:""},tableData.getData=1<Object.keys(inputs).length&&JSON.stringify(inputs),tableData.setUrlOnSearch){var inputs=window.location.origin+window.location.pathname,queryString=$(this).serialize();const url=new URL(queryString?"?"+queryString:inputs,inputs),params=new Map;url.searchParams.forEach((value,key)=>{""===value||params.has(key)||params.set(key,value)}),url.search="",params.forEach((value,key)=>url.searchParams.append(key,value)),tableData.getData||url.searchParams.delete("mode"),window.history.pushState(null,null,url.toString()),e.parent().find(".gv-widget-export-link a[data-nonce-url]").each(function(){let anchorUrl=new URL($(this).data("nonce-url"));url.searchParams.forEach((value,key)=>anchorUrl.searchParams.set(key,value)),$(this).attr("href",anchorUrl.toString())})}gvDataTables.tables[viewId].data=tableData;var currentTableOptions=$table.DataTable().init(),filters=(currentTableOptions._ajax&&($table.DataTable().settings()[0].ajax=currentTableOptions._ajax),$(this).addClass("gv-is-search").attr("data-state",$(this).serialize()).trigger("keyup"),$(".gv-search-clear",$(this)).text(gvGlobals.clear),Object.keys(JSON.parse(tableData.getData)));let filterIndex=0,nonColumnSearch=!1;for(;filterIndex<filters.length&&!nonColumnSearch;){let searchBarInputName=filters[filterIndex].replace("filter_","gv_");"mode"===(searchBarInputName=["gv_start","gv_end"].includes(searchBarInputName)?"date_created":searchBarInputName)?filterIndex++:(nonColumnSearch=!currentTableOptions.columns.some(tableColumn=>tableColumn.name===searchBarInputName),filterIndex++)}currentTableOptions.serverSide||!currentTableOptions.serverSide&&(nonColumnSearch||!gvDataTables.tables[viewId].allRecordsLoaded)?(gvDataTables.tables[viewId].allRecordsLoaded=!tableData.getData,$table.DataTable().ajax.reload()):$table.DataTable().draw()}else this.submit()}})})})}(jQuery);